var __awaiter=this&&this.__awaiter||function(e,t,i,o){function r(e){return e instanceof i?e:new i((function(t){t(e)}))}return new(i||(i=Promise))((function(i,s){function l(e){try{n(o.next(e))}catch(t){s(t)}}function a(e){try{n(o["throw"](e))}catch(t){s(t)}}function n(e){e.done?i(e.value):r(e.value).then(l,a)}n((o=o.apply(e,t||[])).next())}))};var __generator=this&&this.__generator||function(e,t){var i={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},o,r,s,l;return l={next:a(0),throw:a(1),return:a(2)},typeof Symbol==="function"&&(l[Symbol.iterator]=function(){return this}),l;function a(e){return function(t){return n([e,t])}}function n(l){if(o)throw new TypeError("Generator is already executing.");while(i)try{if(o=1,r&&(s=l[0]&2?r["return"]:l[0]?r["throw"]||((s=r["return"])&&s.call(r),0):r.next)&&!(s=s.call(r,l[1])).done)return s;if(r=0,s)l=[l[0]&2,s.value];switch(l[0]){case 0:case 1:s=l;break;case 4:i.label++;return{value:l[1],done:false};case 5:i.label++;r=l[1];l=[0];continue;case 7:l=i.ops.pop();i.trys.pop();continue;default:if(!(s=i.trys,s=s.length>0&&s[s.length-1])&&(l[0]===6||l[0]===2)){i=0;continue}if(l[0]===3&&(!s||l[1]>s[0]&&l[1]<s[3])){i.label=l[1];break}if(l[0]===6&&i.label<s[1]){i.label=s[1];s=l;break}if(s&&i.label<s[2]){i.label=s[2];i.ops.push(l);break}if(s[2])i.ops.pop();i.trys.pop();continue}l=t.call(e,i)}catch(a){l=[6,a];r=0}finally{o=s=0}if(l[0]&5)throw l[1];return{value:l[0]?l[1]:void 0,done:true}}};var __spreadArray=this&&this.__spreadArray||function(e,t,i){if(i||arguments.length===2)for(var o=0,r=t.length,s;o<r;o++){if(s||!(o in t)){if(!s)s=Array.prototype.slice.call(t,0,o);s[o]=t[o]}}return e.concat(s||Array.prototype.slice.call(t))};
/*!
 * Built with Duet Design System
 */import{r as registerInstance,c as createEvent,h,H as Host,g as getElement}from"./index-81967d12.js";import{i as inheritGlobalTheme}from"./themeable-component-cb76be7c.js";import{c as createID}from"./create-id-981107da.js";import{f as isEscapeKey,o as isTabKey,n as isEnterKey,d as isArrowLeftKey,b as isArrowUpKey,a as isArrowRightKey,c as isArrowDownKey}from"./keyboard-utils-88ea1007.js";import{g as getLocaleString}from"./language-utils-bf701d37.js";import{p as parsePossibleJSON}from"./string-utils-5954f458.js";var duetMultiselectCss='@charset "UTF-8";*,*::after,*::before{box-sizing:border-box;padding:0;margin:0;background:transparent;border:0;-moz-appearance:none;-webkit-appearance:none;appearance:none}:host{box-sizing:border-box;padding:0;margin:0;background:transparent;border:0;-moz-appearance:none;-webkit-appearance:none;appearance:none;margin-right:16px !important;margin-bottom:12px !important;display:inline-flex;width:100%;max-width:100%;vertical-align:bottom}:host:last-child,:host:last-of-type{margin-right:0 !important}@media (min-width: 36em){:host{width:calc(50% - 16px - 3px)}:host.duet-expand{width:100% !important}}:host(.duet-m-0){margin:0 !important}.duet-multiselect-tooltip{position:absolute;top:12px;right:0}@media (min-width: 48em){.duet-multiselect-tooltip{position:relative;top:4px;right:auto}}.duet-multiselect-placeholder{position:absolute;top:-9px;left:9px;z-index:200;display:block;width:auto;max-width:60%;padding:0 0.25rem;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;background:white}.duet-multiselect-container{position:relative;width:100%}.duet-multiselect-wrapper{position:relative;width:100%;font-family:"localtapiola-sans", -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol";font-size:1rem;font-weight:400;line-height:1.25}.duet-theme-turva .duet-multiselect-wrapper{font-family:"turva-sans", -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol"}.duet-multiselect-wrapper::after{content:"  "}.duet-multiselect{display:flex;gap:12px;align-items:center;justify-content:flex-start;width:100%;min-width:8rem;padding:12px 14px !important;overflow:hidden;font-family:"localtapiola-sans", -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol";font-size:1rem;font-weight:400;font-variant-numeric:tabular-nums;line-height:1.5;color:#00294d;text-align:left;text-overflow:ellipsis;white-space:nowrap;cursor:pointer;background:white;border:1px solid #909599;border-radius:4px;transition:150ms ease}.duet-multiselect:hover{border-color:#909599;box-shadow:0 0 0 1px #909599}.duet-theme-turva .duet-multiselect:hover{border-color:#747475;box-shadow:0 0 0 1px #747475}.has-error .duet-multiselect:hover{box-shadow:0 0 0 1px #de2362}.duet-theme-turva.has-error .duet-multiselect:hover{box-shadow:0 0 0 1px #e02a0d}.duet-multiselect:focus,.duet-multiselect.duet-multiselect-active{border-color:#0077b3;outline:0;box-shadow:0 0 0 1px #0077b3;transition:none}.duet-theme-turva .duet-multiselect:focus,.duet-theme-turva .duet-multiselect.duet-multiselect-active{border-color:#171c3a;box-shadow:0 0 0 1px #171c3a}.has-error .duet-multiselect:focus,.has-error .duet-multiselect.duet-multiselect-active{box-shadow:0 0 0 1px #de2362}.duet-theme-turva.has-error .duet-multiselect:focus,.duet-theme-turva.has-error .duet-multiselect.duet-multiselect-active{box-shadow:0 0 0 1px #e02a0d}.duet-multiselect[disabled]{color:#00294d !important;cursor:default !important;background:#f5f8fa !important;border-color:#f5f8fa !important;box-shadow:none !important;opacity:1 !important;-webkit-text-fill-color:#00294d !important}.duet-theme-turva .duet-multiselect[disabled]{color:#171c3a !important;background:#f5f5f7 !important;border-color:#f5f5f7 !important;-webkit-text-fill-color:#171c3a !important}.duet-multiselect>:first-child{flex:1}.duet-multiselect .duet-multiselect-badge{position:absolute;right:3rem}.has-error .duet-multiselect{border-color:#de2362 !important}.has-error .duet-multiselect .duet-multiselect-icon{color:#de2362 !important}.duet-theme-turva.has-error .duet-multiselect{border-color:#e02a0d !important}.duet-theme-turva.has-error .duet-multiselect .duet-multiselect-icon{color:#e02a0d !important}.duet-theme-turva .duet-multiselect{font-family:"turva-sans", -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol";color:#171c3a;border-color:#747475}.duet-multiselect svg{width:20px;height:20px;color:#00294d;pointer-events:none}.duet-theme-turva .duet-multiselect svg{color:#171c3a}.duet-multiselect svg.duet-multiselect-icon--rotate{transform:rotate(180deg)}.duet-multiselect-checkboxes{position:absolute;z-index:700;width:100%;padding:16px;margin:8px 0 0;visibility:hidden;background:white;border:1px solid #e1e3e6;border-radius:4px;box-shadow:0 4px 10px 0 rgba(0, 41, 77, 0.15);opacity:0;transition:transform 300ms ease, opacity 300ms ease, visibility 300ms ease;transform:scale(0.96) translateZ(0) translateY(-20px);transform-origin:top right}.duet-theme-turva .duet-multiselect-checkboxes{background:white;border-color:#e4e4e6;box-shadow:0 4px 10px 0 rgba(23, 28, 58, 0.15)}.duet-multiselect-checkboxes.duet-multiselect-checkboxes-active{visibility:visible;opacity:1;transition-property:transform, opacity;transform:scale(1.0001) translateZ(0) translateY(0)}.duet-multiselect-help{display:block;font-family:"localtapiola-sans", -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol";font-size:0.875rem;font-weight:400;line-height:1.25;color:#657787;border-radius:4px}.duet-multiselect-help span{display:block;margin-top:8px}.duet-theme-turva .duet-multiselect-help{color:#747475}.has-error .duet-multiselect-help{color:#de2362}.duet-theme-turva.has-error .duet-multiselect-help{color:#e02a0d}.duet-label-hidden duet-label{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0 0 0 0);border:0}';function toggleInArray(e,t){return e.includes(t)?e.filter((function(e){return e!==t})):__spreadArray(__spreadArray([],e,true),[t],false)}var DuetMultiselect=function(){function e(e){var t=this;registerInstance(this,e);this.duetChange=createEvent(this,"duetChange",3);this.duetFocus=createEvent(this,"duetFocus",7);this.duetBlur=createEvent(this,"duetBlur",7);this.errorId=createID("DuetError");this.labelId=createID("DuetLabel");this.topCaptionId=createID("DuetCaptionTop");this.selectedLangObject={en:"selected",fi:"valittu",sv:"vald"};this.processedItems=[];this.checkboxesVisible=false;this.activeDescendant="";this.margin="auto";this.error="";this.expand=false;this.value=[];this.theme="";this.labelHidden=false;this.identifier=createID("DuetMultiselect");this.placeholder="";this.disabled=false;this.label="label";this.tooltip="";this.tooltipDirection="auto";this.onClick=function(e){e.stopPropagation()};this.onChange=function(e){t.duetChange.emit({originalEvent:e,value:t.value,component:"duet-multiselect"})};this.onBlur=function(e){t.duetBlur.emit({originalEvent:e,value:t.value,component:"duet-multiselect"})};this.onFocus=function(e){t.duetFocus.emit({originalEvent:e,value:t.value,component:"duet-multiselect"})};this.onMultiselectKeyDown=function(e){if(isEscapeKey(e)||isTabKey(e)){if(t.checkboxesVisible){t.checkboxesVisible=false;t.multiselectElement.focus();e.preventDefault()}}};this.onMultiselectInputKeyDown=function(e){if(isEnterKey(e)){e.preventDefault();t.toggleCheckboxes();setTimeout((function(){if(t.checkboxesVisible){var e=t.element.shadowRoot.querySelector("#".concat(t.getOptionIdentifier(0)));if(e){e.focus()}}}),200)}};this.onCheckboxKeyDown=function(e,i){var o;if(isArrowLeftKey(e)||isArrowUpKey(e)){o=t.element.shadowRoot.querySelector("#".concat(t.getOptionIdentifier(i-1)))}else if(isArrowRightKey(e)||isArrowDownKey(e)){o=t.element.shadowRoot.querySelector("#".concat(t.getOptionIdentifier(i+1)))}if(o){o.focus();e.preventDefault();t.activeDescendant=o.id}};this.toggleCheckboxes=function(){t.checkboxesVisible=!t.checkboxesVisible};this.toggleCheckbox=function(e,i){t.value=toggleInArray(t.value,i);t.onChange(e)};this.getOptionIdentifier=function(e){return"".concat(t.identifier,"-option-").concat(e)}}e.prototype.componentWillLoad=function(){inheritGlobalTheme(this);this.isCaptionVisible=!!this.caption;this.refresh()};e.prototype.setFocus=function(e){return __awaiter(this,void 0,void 0,(function(){return __generator(this,(function(t){if(this.multiselectElement){this.multiselectElement.focus(e)}return[2]}))}))};e.prototype.refresh=function(){return __awaiter(this,void 0,void 0,(function(){return __generator(this,(function(e){this.processedItems=parsePossibleJSON(this.items);return[2]}))}))};e.prototype.render=function(){var e=this;var t=getLocaleString(this.selectedLangObject);return h(Host,{onClick:this.onClick,class:{"duet-m-0":this.margin==="none","duet-expand":this.expand}},h("div",{class:{"duet-multiselect-container":true,"duet-label-hidden":this.labelHidden,"duet-theme-turva":this.theme==="turva","duet-input-top-caption-shown":this.isCaptionVisible,"has-error":!!this.error},onKeyDown:function(t){return e.onMultiselectKeyDown(t)}},h("duet-label",{theme:this.theme==="turva"?"turva":"default",class:{"duet-has-tooltip":!!this.tooltip},id:this.labelId,for:this.identifier},this.label),this.tooltip&&h("duet-tooltip",{class:"duet-multiselect-tooltip",direction:this.tooltipDirection,accessibleInputLabel:this.label},this.tooltip),this.caption&&h("duet-caption",{id:this.topCaptionId,size:"medium"},this.caption),h("div",{class:"duet-multiselect-wrapper"},h("button",{id:this.identifier,ref:function(t){return e.multiselectElement=t},class:{"duet-multiselect":true,"duet-multiselect-active":this.checkboxesVisible},tabindex:"0",onClick:function(){return e.toggleCheckboxes()},onFocus:function(t){return e.onFocus(t)},onBlur:function(t){return e.onBlur(t)},role:"combobox","aria-expanded":this.checkboxesVisible?"true":"false","aria-haspopup":"listbox","aria-labelledby":"".concat(this.labelId," ").concat(this.errorId),"aria-owns":"".concat(this.identifier,"-checkboxes"),onKeyDown:function(t){return e.onMultiselectInputKeyDown(t)},disabled:this.disabled},h("span",{role:"textbox","aria-readonly":"true","aria-multiline":"false","aria-autocomplete":"none","aria-controls":"".concat(this.identifier,"-checkboxes")},this.placeholder),this.value&&this.value.length>0&&h("duet-badge",{class:"duet-multiselect-badge",margin:"none",theme:this.theme},this.value.length," ",t,h("duet-visually-hidden",null,", ",this.value.map((function(e){return e.label})).join(", "))),h("svg",{role:"img",class:{"duet-multiselect-icon":true,"duet-multiselect-icon--rotate":this.checkboxesVisible},fill:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},h("path",{d:"m12 18.999c-.4 0-.776-.156-1.059-.438l-10.721-10.72c-.142-.142-.22-.33-.22-.531 0-.2.078-.389.22-.53.142-.142.33-.22.53-.22s.389.078.53.22l10.72 10.719 10.72-10.719c.142-.142.33-.22.53-.22s.389.078.53.22c.142.142.22.33.22.53s-.078.389-.22.53l-10.72 10.72c-.282.283-.659.439-1.06.439z"}))),h("div",{id:"".concat(this.identifier,"-checkboxes"),role:"listbox",class:{"duet-multiselect-checkboxes":true,"duet-multiselect-checkboxes-active":this.checkboxesVisible},"aria-activedescendant":this.activeDescendant,"aria-multiselectable":"true"},this.processedItems&&this.processedItems.map((function(t,i){var o,r;return h("duet-checkbox",{identifier:e.getOptionIdentifier(i),role:"option",label:t.label,value:t.value,key:t.value,checked:(o=e.value)===null||o===void 0?void 0:o.includes(t),"accessible-selected":((r=e.value)===null||r===void 0?void 0:r.includes(t))?"true":undefined,disabled:!e.checkboxesVisible||t.disabled,onDuetChange:function(i){return e.toggleCheckbox(i,t)},onKeyDown:function(t){return e.onCheckboxKeyDown(t,i)},theme:e.theme})})))),h("span",{class:"duet-multiselect-help",id:this.errorId,"aria-live":"assertive","aria-relevant":"additions removals"},this.error&&h("span",null,this.error))))};Object.defineProperty(e.prototype,"element",{get:function(){return getElement(this)},enumerable:false,configurable:true});Object.defineProperty(e,"watchers",{get:function(){return{items:["refresh"]}},enumerable:false,configurable:true});return e}();DuetMultiselect.style=duetMultiselectCss;export{DuetMultiselect as duet_multiselect};